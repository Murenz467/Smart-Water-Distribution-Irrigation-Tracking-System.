INSERT INTO LOCATIONS (LOCATION_ID, DISTRICT, SECTOR, ZONE) VALUES (1, 'Kigali', 'Gasabo', 'Zone A');
INSERT INTO LOCATIONS (LOCATION_ID, DISTRICT, SECTOR, ZONE) VALUES (2, 'Kigali', 'Kicukiro', 'Zone B');
INSERT INTO LOCATIONS (LOCATION_ID, DISTRICT, SECTOR, ZONE) VALUES (3, 'Kigali', 'Nyarugenge', 'Zone C');
INSERT INTO LOCATIONS (LOCATION_ID, DISTRICT, SECTOR, ZONE) VALUES (4, 'Southern', 'Huye', 'Zone D');
INSERT INTO LOCATIONS (LOCATION_ID, DISTRICT, SECTOR, ZONE) VALUES (5, 'Northern', 'Musanze', 'Zone E');
COMMIT;

INSERT INTO WATER_SECTORS (SECTOR_ID, SECTOR_NAME) VALUES (1, 'Irrigation');
INSERT INTO WATER_SECTORS (SECTOR_ID, SECTOR_NAME) VALUES (2, 'Domestic');
INSERT INTO WATER_SECTORS (SECTOR_ID, SECTOR_NAME) VALUES (3, 'Industrial');
COMMIT;

INSERT INTO WATER_METERS (METER_ID, LOCATION_ID, SECTOR_ID, METER_STATUS) VALUES (101, 1, 1, 'ACTIVE');
INSERT INTO WATER_METERS (METER_ID, LOCATION_ID, SECTOR_ID, METER_STATUS) VALUES (102, 2, 2, 'ACTIVE');
INSERT INTO WATER_METERS (METER_ID, LOCATION_ID, SECTOR_ID, METER_STATUS) VALUES (103, 3, 2, 'ACTIVE');
INSERT INTO WATER_METERS (METER_ID, LOCATION_ID, SECTOR_ID, METER_STATUS) VALUES (104, 4, 1, 'INACTIVE');
INSERT INTO WATER_METERS (METER_ID, LOCATION_ID, SECTOR_ID, METER_STATUS) VALUES (105, 5, 3, 'ACTIVE');
COMMIT;

INSERT INTO WATER_CONSUMPTION (CONSUMPTION_ID, METER_ID, CONSUMPTION_DATE, VOLUME) VALUES (1001, 101, TO_DATE('2025-12-01','YYYY-MM-DD'), 120.5);
INSERT INTO WATER_CONSUMPTION (CONSUMPTION_ID, METER_ID, CONSUMPTION_DATE, VOLUME) VALUES (1002, 102, TO_DATE('2025-12-01','YYYY-MM-DD'), 85.0);
INSERT INTO WATER_CONSUMPTION (CONSUMPTION_ID, METER_ID, CONSUMPTION_DATE, VOLUME) VALUES (1003, 103, TO_DATE('2025-12-01','YYYY-MM-DD'), 95.2);
INSERT INTO WATER_CONSUMPTION (CONSUMPTION_ID, METER_ID, CONSUMPTION_DATE, VOLUME) VALUES (1004, 104, TO_DATE('2025-12-01','YYYY-MM-DD'), 0);
INSERT INTO WATER_CONSUMPTION (CONSUMPTION_ID, METER_ID, CONSUMPTION_DATE, VOLUME) VALUES (1005, 105, TO_DATE('2025-12-01','YYYY-MM-DD'), 200.7);
COMMIT;
INSERT INTO SYSTEM_USERS (USER_ID, USERNAME, PASSWORD, ROLE) VALUES (1, 'admin_charles', 'Murenzi', 'ADMIN');
INSERT INTO SYSTEM_USERS (USER_ID, USERNAME, PASSWORD, ROLE) VALUES (2, 'employee1', '12345', 'EMPLOYEE');
INSERT INTO SYSTEM_USERS (USER_ID, USERNAME, PASSWORD, ROLE) VALUES (3, 'employee2', '12345', 'EMPLOYEE');
COMMIT;



SELECT * FROM LOCATIONS;
SELECT * FROM WATER_SECTORS;
SELECT * FROM WATER_METERS;
SELECT * FROM WATER_CONSUMPTION;
SELECT * FROM SYSTEM_USERS;






-- Check WATER_METERS links to valid LOCATIONS and WATER_SECTORS
SELECT wm.METER_ID, l.DISTRICT, ws.SECTOR_NAME
FROM WATER_METERS wm
JOIN LOCATIONS l ON wm.LOCATION_ID = l.LOCATION_ID
JOIN WATER_SECTORS ws ON wm.SECTOR_ID = ws.SECTOR_ID;

-- Check WATER_CONSUMPTION links to valid METERS
SELECT wc.CONSUMPTION_ID, wc.VOLUME, wm.METER_ID
FROM WATER_CONSUMPTION wc
JOIN WATER_METERS wm ON wc.METER_ID = wm.METER_ID;



-- Total water consumption per district
SELECT l.DISTRICT, SUM(wc.VOLUME) AS TOTAL_VOLUME
FROM WATER_CONSUMPTION wc
JOIN WATER_METERS wm ON wc.METER_ID = wm.METER_ID
JOIN LOCATIONS l ON wm.LOCATION_ID = l.LOCATION_ID
GROUP BY l.DISTRICT;

-- Average consumption per sector
SELECT ws.SECTOR_NAME, AVG(wc.VOLUME) AS AVG_VOLUME
FROM WATER_CONSUMPTION wc
JOIN WATER_METERS wm ON wc.METER_ID = wm.METER_ID
JOIN WATER_SECTORS ws ON wm.SECTOR_ID = ws.SECTOR_ID
GROUP BY ws.SECTOR_NAME;



-- Find meters with consumption above average
SELECT METER_ID, VOLUME
FROM WATER_CONSUMPTION
WHERE VOLUME > (SELECT AVG(VOLUME) FROM WATER_CONSUMPTION);

-- Find users with role 'EMPLOYEE'
SELECT USERNAME
FROM SYSTEM_USERS
WHERE ROLE = 'EMPLOYEE';

